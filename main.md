### IB方法的介绍

固体和流体的动量守恒方程可以统一成以下形式：

$\rho\left(u_{t}+u \cdot \nabla u\right)-\operatorname{div} \sigma+\nabla p=f$

其中，$\sigma=\sigma_f,\sigma_s$

$-\operatorname{div}\sigma_f|_{x\in\Omega_s\and\Omega_f}+\operatorname{div}(\sigma_f-\sigma_s)|_{x\in\Omega_s}$

令$F=\operatorname{div}(\sigma_s-\sigma_f)=P_e(F)$

$P_e$描述了弹性物体的本构关系。

因此，这一切都可以归纳为以下三部分的求解：

1. 求解流体的速度
2. 求解固体的位移，进而得到形变梯度
3. 作为源项写进流体的控制方程

这三个部分可以整体求解，或者完全分开求解，或者2，3一起求解，1单独求解，每一种方法都能找到对应的文章。IBLS和IBLS方法的区别是第二部分。

### 力的计算

力的计算中最关键的一步就是形变梯度的求解，这里介绍两种方法。

#### Delta 函数插值

传统的IBFE的方法是在固体的拉格朗日坐标系中求出力，然后在根据固体的欧拉坐标和流体的拉格朗日坐标，利用delta函数，将力施加到流体方程上。

这里面很关键的一步是固体是如何获取速度，如何计算出形变梯度和力，如何将力反馈给流体。

固体的应力求解需要在拉格朗日框架下进行，相乘的基函数对应的是拉格朗日意义上的基函数，在这样的坐标系下计算出

#### 输运方程和水平集函数

IBLS方法的核心是推导出固体的形变梯度随时间变化的函数，它借助两个方程。第一个是输运方程，流场中任意一点的拉格朗日坐标是个常量，因此随体导数为零，根据这个公式可以导出追踪欧拉坐标的方程，对坐标梯度求逆就可以推导出流场中任意点的形变梯度。第二个是水平集方程，它用于追踪固体区域，将非固体区域的形变梯度归零。有了这两个公式以后，我们就可以知道任意时刻任意位置的形变梯度，进而求出任意位置的力。

有两种方法计算形变梯度，一种是用输运方程追踪坐标轨迹，然后求逆就可以得到形变梯度。另一种方法是直接求形变梯度的输运方程。

因为形变梯度方程是双曲型的方程，传统有限元无法求解。有限元框架下求解双曲型方程有两种方法，一种是GLS，一种是间断有限元。我们选取了SUPG方法，它属于GLS的一种，时间离散使用了向后欧拉或者CN这样的隐格式。

但是三维的形变梯度追踪方程有9个变量，每个变量有M个自由度，最差的情况，可能要做(2(9m-1)9m)^9m次乘法与加法，照这样来算，计算量约为流体求解的81倍。从计算效率方面考虑，我不认为可以推广到三维。有限差分之所以可以推广到三维是因为可以显式求解，不用求解庞大的线性方程组。如果采用DG，则可以显式求解，逐个单元求解。

### 流体的求解格式

Chorin的投影方法

SAV方法



#### 数值模拟

###### 1. 方腔流

需要列出一个速度的表格，或者画图。相同时刻，取x=0.5和y=0.5画两幅图，进行比较。

SAV+IBLS, SAV+IBFE, 投影+IBLS, 投影+IBFE



###### 2. 圆盘震动

同上